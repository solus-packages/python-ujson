From fe2171cd98cb4643f68eeab5c659892ce7fa0817 Mon Sep 17 00:00:00 2001
From: Algent Albrahimi <algent@protonmail.com>
Date: Mon, 21 Feb 2022 19:32:10 +0100
Subject: [PATCH] Use double-conversion from the system

---
 setup.py | 11 ++++-------
 1 file changed, 4 insertions(+), 7 deletions(-)

diff --git a/setup.py b/setup.py
index 453dc31..4cc8fac 100644
--- a/setup.py
+++ b/setup.py
@@ -3,24 +3,21 @@ from glob import glob
 
 from setuptools import Extension, setup
 
-dconv_source_files = glob("./deps/double-conversion/double-conversion/*.cc")
-dconv_source_files.append("./lib/dconv_wrapper.cc")
-
 strip_flags = ["-Wl,--strip-all"] if platform.system() == "Linux" else []
 
 module1 = Extension(
     "ujson",
-    sources=dconv_source_files
-    + [
+    sources=[
+        "./lib/dconv_wrapper.cc",
         "./python/ujson.c",
         "./python/objToJSON.c",
         "./python/JSONtoObj.c",
         "./lib/ultrajsonenc.c",
         "./lib/ultrajsondec.c",
     ],
-    include_dirs=["./python", "./lib", "./deps/double-conversion/double-conversion"],
+    include_dirs=["./python", "./lib", "/usr/include/double-conversion"],
     extra_compile_args=["-D_GNU_SOURCE"],
-    extra_link_args=["-lstdc++", "-lm"] + strip_flags,
+    extra_link_args=["-lstdc++", "-lm", "-ldouble-conversion"],
 )
 
 with open("python/version_template.h") as f:
-- 
2.35.1

